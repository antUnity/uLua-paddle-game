<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uLua Paddle Game: uLua Paddle Game</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="uLua-160x160.png"/></td>
  <td id="projectalign">
   <div id="projectname">uLua Paddle Game<span id="projectnumber">&#160;v1.0.0</span>
   </div>
   <div id="projectbrief">A paddle game for Unity  made as an example use of the uLua toolkit.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__c___users__aris__documents__projects__titania__unity__assets__plugins_u_lua_example__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> Paddle Game </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >In this project I have developed an API for a basic paddle game to demonstrate the flexibility of the <a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> API framework as a modding tool.</p>
<p ><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> is a Game API framework for Unity. It aims to streamline the development of a Game API in Lua for your Unity Project.</p>
<p ><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> wraps around MoonSharp and provides an object oriented framework for API development in Lua. It works by setting up an application-wide Lua context and exposing game objects to it. Objects exposed to Lua can then be accessed in Lua scripts to implement game behaviour in your project. User-defined Lua scripts may be executed at runtime to allow modding of your project.</p>
<p ><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> implements the following features:</p><ul>
<li>Script execution framework which allows Lua scripts to be executed from the Resources folder or an external directory.</li>
<li>Event handling system which allows you to invoke events from C# and handle them in Lua.</li>
<li>Base classes which streamline exposing your game objects and data structures to Lua in order to develop your Game API.</li>
<li>Callback function system for your Game API objects.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Dependencies</h1>
<ul>
<li><a href="https://assetstore.unity.com/packages/tools/moonsharp-33776">MoonSharp for Unity</a></li>
<li><a href="https://assetstore.unity.com/packages/slug/226043">uLua for Unity</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Documentation</h1>
<p >This document is accompanied by source code documentation, which is found on the <a href="https://antunity.github.io/uLua-paddle-game/">GitHub pages</a> of this repository. For any further questions do not hesitate to contact <a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'an'+'tso'+'ft'+'war'+'e.'+'co.'+'uk'; return false;">suppo<span class="obfuscator">.nosp@m.</span>rt@a<span class="obfuscator">.nosp@m.</span>ntsof<span class="obfuscator">.nosp@m.</span>twar<span class="obfuscator">.nosp@m.</span>e.co.<span class="obfuscator">.nosp@m.</span>uk</a>.</p>
<p >Working on this project and documentation has taken many hours. Please support me by starring this project on GitHub. If you purchased <a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a>, please leave a review on the asset store! Follow my <a href="https://twitter.com/_ANTSoftware" title="@_ANTSoftware">Twitter</a>!</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Usage Tutorial</h1>
<p ><em><b>Note: It is recommended to read the <a href="https://antunity.github.io/uLua-docs">uLua Usage Tutorial</a> in the full documentation of <a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> before reading this document.</b></em></p>
<p >The basic behaviour and game logic of this game are implemented in Unity Engine. Specifically:</p><ul>
<li>Controller scripts for <a class="el" href="classu_lua_1_1_paddle_game_1_1_paddle.html" title="Wrapper class used to expose paddle objects to Lua.">uLua.PaddleGame.Paddle</a> and <a class="el" href="classu_lua_1_1_paddle_game_1_1_ball.html" title="Wrapper class used to expose ball objects to Lua.">uLua.PaddleGame.Ball</a> objects.</li>
<li>Invoking of game events and object callback functions.</li>
<li>Collision detection logic for all objects.</li>
</ul>
<p >However, the Unity scene for this game does not contain a ball, paddle, or bricks. The levels for this game are set up entirely through the Game API in Lua.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
1. Scripting API</h2>
<h3><a class="anchor" id="autotoc_md5"></a>
1.1. Game Objects</h3>
<p >The Game API contains the following objects/data structures:</p><ul>
<li><b>Game</b>: Manager object which is used to create and keep track of Balls, Paddles, and Bricks within the level.</li>
<li><b>Settings</b>: Data structure which contains the current level, remaining lives, score, and other game settings.</li>
<li><b>LevelText</b>: UI element to display the current level.</li>
<li><b>LivesText</b>: UI element to display the remaining lives.</li>
<li><b>ScoreText</b>: UI element to display the player score.</li>
</ul>
<p >All ball, brick, and paddle objects are also exposed to the Game API, however, their names are based on the application runtime, unless specified otherwise in the corresponding command:</p>
<div class="fragment"><div class="line">Game:AddBall(0, 0, 5, 0.5, &quot;BallName&quot;);</div>
</div><!-- fragment --><p >Omitting the last parameter in this method will auto-generate a name of the object. The following are examples of auto-generated names:</p>
<div class="fragment"><div class="line">Each Lua object contains various methods as defined in their corresponding Unity scripts. For a full list of the members of all object types,</div>
<div class="line">refer to the relevant source code documentation. Remember that all public members of the following classes are accessible in the Game API.</div>
<div class="line">- uLua.PaddleGame.Ball</div>
<div class="line">- uLua.PaddleGame.Brick</div>
<div class="line">- uLua.PaddleGame.Paddle</div>
<div class="line">- uLua.PaddleGame.Game</div>
<div class="line">- uLua.PaddleGame.Settings</div>
<div class="line">- uLua.PaddleGame.UIText</div>
<div class="line"> </div>
<div class="line">#### 1.2. Events and Callback Functions</div>
<div class="line"> </div>
<div class="line">The following events are invoked during the game and may be handled in Lua:</div>
<div class="line">- **BoundaryHit**: Invoked when a ball hits the bottom screen boundary.</div>
<div class="line">- **BrickDestroyed**: Invoked when a brick is destroyed. Passes one argument, which is the brick object that was destroyed.</div>
<div class="line">- **BrickHit**: Invoked when a brick is hit. Passes one argument, which is the brick object that was hit.</div>
<div class="line">- **SceneLoaded**: Invoked when the scene is loaded.</div>
<div class="line">- **UIUpdate**: Invoked when the game level, player lives, or player score are altered.</div>
<div class="line"> </div>
<div class="line">The following object callback functions are invoked during the game and may be handled in Lua:</div>
<div class="line">- **Ball:OnHit()**: Called when a ball hits an object. To handle in the API, the ball name must be known.</div>
<div class="line">- **Brick:OnHit()**:  Called when a brick hits an object. To handle in the API, the brick name must be known.</div>
<div class="line">- **Paddle:OnHit()**: Called when a paddle hits an object. To handle in the API, the paddle name must be known.</div>
<div class="line"> </div>
<div class="line">### 2. Modding the Game</div>
<div class="line"> </div>
<div class="line">The Lua script which is executed by default for this game is listed at the end of this section.</div>
<div class="line">You may mod the game by extending this script (adding custom Lua scripts at the end) or replacing the original script entirely.</div>
<div class="line"> </div>
<div class="line">To do that, you must place your new Lua scripts in the appropriate external directory.  The external directory is set to Unity&#39;s ```Application.persistentDataPath``` by default.</div>
<div class="line">For more information for different platforms, check the [relevant Unity documentation](https://docs.unity3d.com/ScriptReference/Application-persistentDataPath.html).</div>
<div class="line"> </div>
<div class="line">For this project, and for Windows specifically, the directory for the scripts would be the following:</div>
</div><!-- fragment --><p> C:\Users\{User}\AppData\LocalLow\ANT Software\Paddle Game\ </p><div class="fragment"><div class="line">In order to replace the original scene script you must create a file named ***PaddleGame.lua*** in this directory. I recommend copying the script below to start making small tweaks to familiarize yourself with the game API.</div>
<div class="line"> </div>
<div class="line">In order to extend the original scene script you may add any lua scripts in the &quot;UserScripts&quot; folder within the external directory. Again, for Windows that would be the following:</div>
</div><!-- fragment --><p> C:\Users\{User}\AppData\LocalLow\ANT Software\Paddle Game\UserScripts\ </p><div class="fragment"><div class="line">***PaddleGame.lua***</div>
</div><!-- fragment --><p> &ndash;[[ June 2022 ]] &ndash;[[ This Lua script implements a large portion of the gameplay in this simple Paddle-style game. ]] &ndash;[[ It is meant to demonstrate the flexibility of the <a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> API framework as a modding tool. ]]</p>
<p >math.randomseed(os.time()); &ndash; Used to generate random seed.</p>
<p >local BrickColors = { &ndash; Brick color table. Used to color blocks by different health values. {1.0, 0.0, 0.0}, &ndash; (1) Red {1.0, 0.5, 0.0}, &ndash; (2) Orange {1.0, 1.0, 0.0}, &ndash; (3) Yellow {0.5, 1.0, 0.0}, &ndash; (4) Lawn Green {0.0, 1.0, 0.0}, &ndash; (5) Green {0.0, 1.0, 0.5}, &ndash; (6) Spring Green {0.0, 1.0, 1.0}, &ndash; (7) Aqua {0.0, 0.5, 1.0}, &ndash; (8) Dodger Blue {0.0, 0.0, 1.0}, &ndash; (9) Blue {1.0, 0.0, 1.0}, &ndash; (10) Magenta }</p>
<p >&ndash;[[ Methods ]] &ndash;[[ The following methods are fully implemented in Lua and have no equivalent in Unity. ]] &ndash;[[ They are defined as members of the 'Settings' and 'Game' objects for decorative purposes. ]]</p>
<p >&ndash; Used to increment the game level after clearing the scene. This function ends by starting a new level. &ndash; For each level increment, the game is sped up. Even levels award a bonus life. function Game:OnLevelFinished() &ndash; Increment level if (Settings.Level%2 == 0) then Settings:AddLife(); end &ndash; Add life only on even levels. Settings:AddLevel();</p>
<p >&ndash; Speed Up Game if (Settings.Level &lt;= Settings.MaximumLevel) then Game:SpeedUp(); else Settings.Level = Settings.MaximumLevel; end</p>
<p >&ndash; Start new level self:Start(); end</p>
<p >&ndash; Used to reset the game state when all lives are lost. function Settings:Reset() Game:SlowDown();</p>
<p >self.Level = 1; &ndash; Used to keep track of the current level. self.Lives = 3; &ndash; Used to keep track of remaining lives. self.Score = 0; &ndash; Used to keep track of player score. self.MaximumLevel = 10; &ndash; Used to indicate the maximum game level. self.Delay = 0.5; &ndash; Delay before the ball is set in motion (in seconds).</p>
<p >self.SpeedIncrement = 0.125; &ndash; Ball/Paddle speed increment per level. self.ColorMultiplier = 0.75; &ndash; Multiplier to adjust the brick color intensity.</p>
<p >Game:OnUIUpdate(); &ndash; Force UI Update. end</p>
<p >&ndash; Used to generate a random arrangement of bricks. &ndash; The health for each brick is assigned randomly to a value between 1 and the current level. &ndash; The color for each brick is assigned based on its Health and by using the BrickColors table. function Game:Start() &ndash; Clear up scene self:Clear();</p>
<p >&ndash; Set up Paddle and Ball local SpeedIncrement = Settings.TotalSpeedIncrement; self:AddBall(0, -1.75, 4+SpeedIncrement, Settings.Delay); self:AddPaddle(0, -2.25, 6+SpeedIncrement, SpeedIncrement+1);</p>
<p >&ndash; Generate random level <br  />
 local Columns = math.random(Settings.Level/2+1, Settings.Level+2); local Rows = Settings.Level+2;</p>
<p >for j=Rows/2-1,-Rows/2+1,-1 do local Increment = 1; Columns = Columns -1; if (Columns &lt; 1) then Increment = -1; end for i=-Columns/2,Columns/2,Increment do local Health = math.random(1, Settings.Level/2+j); if (Health &lt; 1) then Health = 1; elseif (Health &gt; 10) then Health = 10; end local Brick = Game:AddBrick(i*0.6125, j*0.33+1.0, Health); Brick.Color = Color.__new(BrickColors[Health][1]*Settings.ColorMultiplier, BrickColors[Health][2]*Settings.ColorMultiplier, BrickColors[Health][3]*Settings.ColorMultiplier); end end end</p>
<p >&ndash;[[ Event Handlers ]] &ndash;[[ The following event handlers are fully implemented in Lua. They are defined as members of the 'Game' object for ]] &ndash;[[ decorative purposes. Events are registered within the Unity scene and then invoked in Unity when appropriate. ]]</p>
<p >&ndash; Called when the ball hits the bottom boundary. &ndash; Decreases lives by one and resets the game state when the last ball hits the bottom of the screen. function Game:OnBoundaryHit(Ball) if (self.NumBalls &gt;= 2) then &ndash; Remove extra balls self:RemoveBall(Ball); else Settings:AddLife(-1);</p>
<p >&ndash; Reset game state if all lives were used if (Settings.Lives &lt; 0) then self:OnSceneLoaded(); else &ndash; Reset Paddle/Ball positions self:ResetPositions(); end end end</p>
<p >&ndash; Called when a brick is destroyed. Chance to generate an extra ball. &ndash; Removes brick from the scene and increments player score. Restarts level if all bricks are destroyed. function Game:OnBrickDestroyed(Brick) &ndash; Update score Settings:AddScore(10*Settings.Level);</p>
<p >&ndash; Extra ball chance local Chance = Brick.MaxHealth/Settings.MaximumLevel;</p>
<p >local Roll = math.random(0, 100); if (Roll/100 &lt;= Chance) then self:AddBall(0, -1.75, 4+Settings.TotalSpeedIncrement, Settings.Delay); end</p>
<p >&ndash; Remove Brick self:RemoveBrick(Brick);</p>
<p >&ndash; Check if the level is finished if (self.NumBricks == 0) then self:OnLevelFinished(); end end</p>
<p >&ndash; Called when a brick is hit. &ndash; Damages the block and updates its color. Also increments player score. function Game:OnBrickHit(Brick) &ndash; Update score Settings:AddScore(10*Settings.Level);</p>
<p >&ndash; Change brick color local Health = Brick.Health-1; if (Health &gt; 0) then Brick.Color = Color.__new(BrickColors[Health][1]*Settings.ColorMultiplier, BrickColors[Health][2]*Settings.ColorMultiplier, BrickColors[Health][3]*Settings.ColorMultiplier); end</p>
<p >Brick:Damage(1); end</p>
<p >&ndash; Resets settings and starts the game. function Game:OnSceneLoaded() Settings:Reset(); self:Start(); end</p>
<p >&ndash; Updates all UIText objects. function Game:OnUIUpdate() LevelText.Message = "LEVEL: " .. Settings.Level; LivesText.Message = "LIVES: " .. Settings.Lives; ScoreText.Message = "SCORE: " .. Settings.Score; end</p>
<p >&ndash; The following commands register event handlers for different events invoked within Unity. RegisterEventHandler("BoundaryHit", "OnBoundaryHit", Game); &ndash; Callback for BoundaryHit event. RegisterEventHandler("BrickDestroyed", "OnBrickDestroyed", Game); &ndash; Callback for BrickDestroyed event. RegisterEventHandler("BrickHit", "OnBrickHit", Game); &ndash; Callback for BrickHit event. RegisterEventHandler("SceneLoaded", "OnSceneLoaded", Game); &ndash; Callback for SceneLoad event. RegisterEventHandler("UIUpdate", "OnUIUpdate", Game); &ndash; Callback for UIUpdate event. ``` </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
