<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uLua Paddle Game: uLua Paddle Game</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="uLua-160x160.png"/></td>
  <td id="projectalign">
   <div id="projectname">uLua Paddle Game<span id="projectnumber">&#160;v1.2.0</span>
   </div>
   <div id="projectbrief">A paddle game for Unity  made as an example use of the uLua toolkit.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> Paddle Game </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_C__Users_Aris_Documents_Projects_Titania_uTitania_Assets_Plugins_uLua_example_README"></a> In this project I have developed an API for a basic paddle game to demonstrate the flexibility of the <a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> API framework as a modding tool.</p>
<p ><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> is a Lua Modding framework for Unity. It enables the development of a Lua API which may be used to mod your Unity Project.</p>
<p ><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> wraps around MoonSharp and provides an object oriented Lua Modding framework. It works by setting up an application-wide Lua context and exposing game objects to it. Objects exposed to the Lua context can then be accessed in Lua, allowing users to modify your game at runtime through the use of Lua scripts.</p>
<p ><a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> implements the following features:</p><ul>
<li>Script execution framework which allows Lua scripts to be executed from the Resources folder or an external directory.</li>
<li>Event handling system which allows you to invoke events in C# and handle them in Lua.</li>
<li>Base classes which expose your game objects and data structures to Lua.</li>
<li>Callback function system for your API objects.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Dependencies</h1>
<ul>
<li><a href="https://assetstore.unity.com/packages/tools/moonsharp-33776">MoonSharp for Unity</a></li>
<li><a href="https://bit.ly/uLuaAsset">uLua for Unity</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Documentation</h1>
<p >This document is accompanied by source code documentation, which is found on the <a href="https://bit.ly/PaddleDemoDocs">GitHub pages</a> of the project's repository. For any further questions do not hesitate to contact <a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'an'+'tso'+'ft'+'war'+'e.'+'co.'+'uk'; return false;">suppo<span class="obfuscator">.nosp@m.</span>rt@a<span class="obfuscator">.nosp@m.</span>ntsof<span class="obfuscator">.nosp@m.</span>twar<span class="obfuscator">.nosp@m.</span>e.co.<span class="obfuscator">.nosp@m.</span>uk</a>.</p>
<p >This project is the result of many hours of hard work. Please support me by starring this project on GitHub. If you purchased <a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a>, please leave a review on the asset store! Follow my <a href="https://twitter.com/_ANTSoftware" title="@_ANTSoftware">Twitter</a>!</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Usage Tutorial</h1>
<p ><em><b>Note: It is recommended to read the <a href="https://bit.ly/uLuaDocs">uLua Usage Tutorial</a> in the full documentation of <a class="el" href="namespaceu_lua.html" title="Namespace containing the uLua project.">uLua</a> before reading this document.</b></em></p>
<p >The basic behaviour and game logic of this game are implemented in Unity Engine. Specifically:</p><ul>
<li>Controller scripts for <a class="el" href="classu_lua_1_1_paddle_game_1_1_paddle.html" title="Wrapper class which exposes paddle objects to the API.">uLua.PaddleGame.Paddle</a> and <a class="el" href="classu_lua_1_1_paddle_game_1_1_ball.html" title="Wrapper class which exposes ball objects to the API.">uLua.PaddleGame.Ball</a> objects.</li>
<li>Invoking of game events and object callback functions.</li>
<li>Collision detection logic for all objects.</li>
</ul>
<p >However, the Unity scene for this game does not contain a ball, paddle, or bricks. The levels for this game are set up entirely through the Lua API.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
1. Modding the Game</h2>
<p >The Lua script which is executed by default for this game is listed at the end of this section. You may mod the game by replacing the original script entirely or by extending it.</p>
<p >To do that, you must place your new Lua scripts in the appropriate external directory. The external directory is set to Unity's <code>Application.persistentDataPath</code> by default. For more information for different platforms, check the <a href="https://docs.unity3d.com/ScriptReference/Application-persistentDataPath.html">relevant Unity documentation</a>.</p>
<p >For this project, and for Windows specifically, the directory for the scripts would be the following:</p>
<div class="fragment"><div class="line">C:\Users\{User}\AppData\LocalLow\ANT Software\Paddle Game\Scripts\PaddleGame\</div>
</div><!-- fragment --><p >In order to replace the original scene script you must create a file named <em><b>PaddleGame.lua</b></em> in this directory. You may also create other scripts in this directory which will be executed after the scene script. I recommend copying the script below to start making small tweaks to familiarize yourself with the game API.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
2. Scripting API</h2>
<h3><a class="anchor" id="autotoc_md6"></a>
2.1. Game Objects</h3>
<p >The API contains the following objects/data structures:</p><ul>
<li><b>Game</b>: Manager object which is used to create and keep track of Balls, Paddles, and Bricks within the level.</li>
<li><b>Settings</b>: Data structure which contains the current level, remaining lives, score, and other game settings.</li>
<li><b>LevelText</b>: UI element to display the current level.</li>
<li><b>LivesText</b>: UI element to display the remaining lives.</li>
<li><b>ScoreText</b>: UI element to display the player score.</li>
<li><b>HighScoreText</b>: UI element to display the player high score.</li>
</ul>
<p >All ball, brick, and paddle objects are also exposed to the API, however, their names are based on the application runtime, unless specified otherwise in the corresponding command:</p>
<div class="fragment"><div class="line">Game:AddBall(0, 0, 5, 0.5, &quot;BallName&quot;);</div>
</div><!-- fragment --><p >Omitting the last parameter in this method will auto-generate a name of the object. The following is an example of an auto-generated name:</p>
<div class="fragment"><div class="line">Ball12345</div>
</div><!-- fragment --><p >Each Lua object contains various methods as defined in their corresponding Unity scripts. For a full list of the members of all object types, refer to the relevant source code documentation. Remember that all public members of the following classes are accessible in the Lua API.</p><ul>
<li><a class="el" href="classu_lua_1_1_paddle_game_1_1_ball.html" title="Wrapper class which exposes ball objects to the API.">uLua.PaddleGame.Ball</a></li>
<li><a class="el" href="classu_lua_1_1_paddle_game_1_1_brick.html" title="Wrapper class which exposes brick objects to the API.">uLua.PaddleGame.Brick</a></li>
<li><a class="el" href="classu_lua_1_1_paddle_game_1_1_paddle.html" title="Wrapper class which exposes paddle objects to the API.">uLua.PaddleGame.Paddle</a></li>
<li><a class="el" href="classu_lua_1_1_paddle_game_1_1_game.html" title="Manages all ball, brick, and paddle objects in the scene and keeps track of various game settings.">uLua.PaddleGame.Game</a></li>
<li><a class="el" href="classu_lua_1_1_paddle_game_1_1_settings.html" title="Class which keeps track of various game settings.">uLua.PaddleGame.Settings</a></li>
<li><a class="el" href="classu_lua_1_1_paddle_game_1_1_u_i_text.html" title="Wrapper class which exposes a UI Text object to the API.">uLua.PaddleGame.UIText</a></li>
</ul>
<h3><a class="anchor" id="autotoc_md7"></a>
2.2. Events and Callback Functions</h3>
<p >The following events are invoked during the game and may be handled in Lua:</p><ul>
<li><b>BoundaryHit</b>: Invoked when a ball hits the bottom screen boundary.</li>
<li><b>BrickDestroyed</b>: Invoked when a brick is destroyed. Passes one argument, which is the brick object that was destroyed.</li>
<li><b>BrickHit</b>: Invoked when a brick is hit. Passes one argument, which is the brick object that was hit.</li>
<li><b>SceneLoaded</b>: Invoked when the scene is loaded.</li>
<li><b>UIUpdate</b>: Invoked when the game level, player lives, or player score are altered.</li>
</ul>
<p >The following object callback functions are invoked during the game and may be handled in Lua:</p><ul>
<li><b>Ball:OnHit()</b>: Called when a ball hits an object. To handle in the API, the ball name must be known.</li>
<li><b>Brick:OnHit()</b>: Called when a brick hits an object. To handle in the API, the brick name must be known.</li>
<li><b>Paddle:OnHit()</b>: Called when a paddle hits an object. To handle in the API, the paddle name must be known.</li>
</ul>
<p ><em><b>PaddleGame.lua</b></em> </p><div class="fragment"><div class="line">--[[ August 2022                                                                                                        ]]</div>
<div class="line">--[[ This Lua script implements a large portion of the gameplay in this simple Paddle-style game.                       ]]</div>
<div class="line">--[[ It is meant to demonstrate the flexibility of the uLua API framework as a modding tool.                            ]]</div>
<div class="line"> </div>
<div class="line">math.randomseed(os.time());                 -- Used to generate random seed.</div>
<div class="line"> </div>
<div class="line">local BrickColors = {                       -- Brick color table. Used to color blocks by different health values.</div>
<div class="line">    {1.0, 0.0, 0.0},                        -- (1) Red</div>
<div class="line">    {1.0, 0.5, 0.0},                        -- (2) Orange</div>
<div class="line">    {1.0, 1.0, 0.0},                        -- (3) Yellow</div>
<div class="line">    {0.5, 1.0, 0.0},                        -- (4) Lawn Green</div>
<div class="line">    {0.0, 1.0, 0.0},                        -- (5) Green</div>
<div class="line">    {0.0, 1.0, 0.5},                        -- (6) Spring Green</div>
<div class="line">    {0.0, 1.0, 1.0},                        -- (7) Aqua</div>
<div class="line">    {0.0, 0.5, 1.0},                        -- (8) Dodger Blue</div>
<div class="line">    {0.0, 0.0, 1.0},                        -- (9) Blue</div>
<div class="line">    {1.0, 0.0, 1.0},                        -- (10) Magenta</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">--[[ Settings                                                                                                           ]]</div>
<div class="line"> </div>
<div class="line">Settings.MaximumLevel = 10;                 -- Used to indicate the maximum game level.</div>
<div class="line">Settings.Delay = 0.5;                       -- Delay before the ball is set in motion (in seconds).</div>
<div class="line"> </div>
<div class="line">Settings.SpeedIncrement = 0.125;            -- Ball/Paddle speed increment per level.</div>
<div class="line">Settings.ColorMultiplier = 0.75;            -- Multiplier to adjust the brick color intensity.</div>
<div class="line"> </div>
<div class="line">--[[ Methods                                                                                                            ]]</div>
<div class="line">--[[ The following methods are fully implemented in Lua and have no equivalent in Unity.                                ]]</div>
<div class="line">--[[ They are defined as members of the &#39;Settings&#39; and &#39;Game&#39; objects for decorative purposes.                          ]]</div>
<div class="line"> </div>
<div class="line">-- Used to increment the game level after clearing the scene. This function ends by starting a new level.</div>
<div class="line">-- For each level increment, the game is sped up. Even levels award a bonus life.</div>
<div class="line">function Game:OnLevelFinished()</div>
<div class="line">    -- Increment level</div>
<div class="line">    if (Settings.Level%2 == 0) then Settings:AddLife(); end -- Add life only on even levels.</div>
<div class="line">    Settings:AddLevel();</div>
<div class="line">    </div>
<div class="line">    -- Speed Up Game</div>
<div class="line">    if (Settings.Level &lt;= Settings.MaximumLevel) then </div>
<div class="line">        Game:SpeedUp();</div>
<div class="line">    else</div>
<div class="line">        Settings.Level = Settings.MaximumLevel;</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    -- Start new level</div>
<div class="line">    self:Start();</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Used to generate a random arrangement of bricks.</div>
<div class="line">-- The health for each brick is assigned randomly to a value between 1 and the current level.</div>
<div class="line">-- The color for each brick is assigned based on its Health and by using the BrickColors table.</div>
<div class="line">function Game:Start()</div>
<div class="line">    -- Clear up scene</div>
<div class="line">    self:Clear();</div>
<div class="line">    </div>
<div class="line">    -- Set up Paddle and Ball</div>
<div class="line">    local SpeedIncrement = Settings.TotalSpeedIncrement;</div>
<div class="line">    self:AddBall(0, -1.75, 4+SpeedIncrement, Settings.Delay);</div>
<div class="line">    self:AddPaddle(0, -2.25, 6+SpeedIncrement, SpeedIncrement+1);</div>
<div class="line">    </div>
<div class="line">    -- Generate random level    </div>
<div class="line">    local Columns = math.random(Settings.Level/2+1, Settings.Level+2);</div>
<div class="line">    local Rows = Settings.Level+2;</div>
<div class="line">    </div>
<div class="line">    for j=Rows/2-1,-Rows/2+1,-1 do</div>
<div class="line">        local Increment = 1;</div>
<div class="line">        Columns = Columns -1;</div>
<div class="line">        if (Columns &lt; 1) then Increment = -1; end</div>
<div class="line">        for i=-Columns/2,Columns/2,Increment do</div>
<div class="line">            local Health = math.random(1, Settings.Level/2+j);</div>
<div class="line">            if (Health &lt; 1) then Health = 1; elseif (Health &gt; 10) then Health = 10; end</div>
<div class="line">            local Brick = Game:AddBrick(i*0.6125, j*0.33+1.0, Health);</div>
<div class="line">            Brick.Color = Color.__new(BrickColors[Health][1]*Settings.ColorMultiplier, BrickColors[Health][2]*Settings.ColorMultiplier, BrickColors[Health][3]*Settings.ColorMultiplier);</div>
<div class="line">        end</div>
<div class="line">    end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--[[ Event Handlers                                                                                                     ]]</div>
<div class="line">--[[ The following event handlers are fully implemented in Lua. They are defined as members of the &#39;Game&#39; object for    ]]</div>
<div class="line">--[[ decorative purposes. Events are registered within the Unity scene and then invoked in Unity when appropriate.      ]]</div>
<div class="line"> </div>
<div class="line">-- Called when the ball hits the bottom boundary.</div>
<div class="line">-- Decreases lives by one and resets the game state when the last ball hits the bottom of the screen.</div>
<div class="line">function Game:OnBoundaryHit(Ball)</div>
<div class="line">    if (self.NumBalls &gt;= 2) then</div>
<div class="line">    -- Remove extra balls </div>
<div class="line">        self:RemoveBall(Ball);</div>
<div class="line">    else</div>
<div class="line">        Settings:AddLife(-1);</div>
<div class="line">        </div>
<div class="line">        -- Reset game state if all lives were used</div>
<div class="line">        if (Settings.Lives &lt; 0) then</div>
<div class="line">            self:Reset();</div>
<div class="line">        else</div>
<div class="line">        -- Reset Paddle/Ball positions</div>
<div class="line">            self:ResetPositions();</div>
<div class="line">        end</div>
<div class="line">    end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Called when a brick is destroyed. Chance to generate an extra ball.</div>
<div class="line">-- Removes brick from the scene and increments player score. Restarts level if all bricks are destroyed.</div>
<div class="line">function Game:OnBrickDestroyed(Brick)</div>
<div class="line">    -- Update score</div>
<div class="line">    Settings:AddScore(10*Settings.Level);</div>
<div class="line">    </div>
<div class="line">    -- Extra ball chance</div>
<div class="line">    local Chance = Brick.MaxHealth/Settings.MaximumLevel;</div>
<div class="line">    </div>
<div class="line">    local Roll = math.random(0, 100);</div>
<div class="line">    if (Roll/100 &lt;= Chance) then</div>
<div class="line">        self:AddBall(0, -1.75, 4+Settings.TotalSpeedIncrement, Settings.Delay);</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    -- Remove Brick</div>
<div class="line">    self:RemoveBrick(Brick);</div>
<div class="line">    </div>
<div class="line">    -- Check if the level is finished</div>
<div class="line">    if (self.NumBricks == 0) then</div>
<div class="line">        self:OnLevelFinished();</div>
<div class="line">    end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Called when a brick is hit.</div>
<div class="line">-- Damages the block and updates its color. Also increments player score.</div>
<div class="line">function Game:OnBrickHit(Brick)</div>
<div class="line">    -- Update score</div>
<div class="line">    Settings:AddScore(10*Settings.Level);</div>
<div class="line"> </div>
<div class="line">    -- Change brick color</div>
<div class="line">    local Health = Brick.Health-1;</div>
<div class="line">    if (Health &gt; 0) then </div>
<div class="line">        Brick.Color = Color.__new(BrickColors[Health][1]*Settings.ColorMultiplier, BrickColors[Health][2]*Settings.ColorMultiplier, BrickColors[Health][3]*Settings.ColorMultiplier);</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    Brick:Damage(1);</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- The following commands register event handlers for different events invoked within Unity.</div>
<div class="line">RegisterEventHandler(&quot;BoundaryHit&quot;, &quot;OnBoundaryHit&quot;, Game);         -- Callback for BoundaryHit event.</div>
<div class="line">RegisterEventHandler(&quot;BrickDestroyed&quot;, &quot;OnBrickDestroyed&quot;, Game);   -- Callback for BrickDestroyed event.</div>
<div class="line">RegisterEventHandler(&quot;BrickHit&quot;, &quot;OnBrickHit&quot;, Game);               -- Callback for BrickHit event.</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
